info: 28.08.2022 18:10:38.006 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (39ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT 1
info: 28.08.2022 18:10:38.085 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (20ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      IF SERVERPROPERTY('EngineEdition') <> 5
      BEGIN
          ALTER DATABASE [Test1] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
      END;
info: 28.08.2022 18:10:38.143 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (58ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      DROP DATABASE [Test1];
info: 28.08.2022 18:10:38.891 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (293ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      CREATE DATABASE [Test1];
info: 28.08.2022 18:10:39.025 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (133ms) [Parameters=[], CommandType='Text', CommandTimeout='60']
      IF SERVERPROPERTY('EngineEdition') <> 5
      BEGIN
          ALTER DATABASE [Test1] SET READ_COMMITTED_SNAPSHOT ON;
      END;
info: 28.08.2022 18:10:39.036 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT 1
info: 28.08.2022 18:10:39.204 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (17ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [artists] (
          [ArtistId] int NOT NULL IDENTITY,
          [FullName] nvarchar(max) NOT NULL,
          CONSTRAINT [PK_artists] PRIMARY KEY ([ArtistId])
      );
info: 28.08.2022 18:10:39.207 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [authors] (
          [Id] int NOT NULL IDENTITY,
          [FName] nvarchar(max) NOT NULL,
          [SomeNum] int NOT NULL,
          [MyProperty] int NOT NULL,
          [LName] nvarchar(max) NOT NULL,
          CONSTRAINT [PK_authors] PRIMARY KEY ([Id])
      );
info: 28.08.2022 18:10:39.209 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (2ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [works] (
          [WorkId] int NOT NULL IDENTITY,
          [Name] nvarchar(max) NOT NULL,
          CONSTRAINT [PK_works] PRIMARY KEY ([WorkId])
      );
info: 28.08.2022 18:10:39.213 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [books] (
          [Id] int NOT NULL IDENTITY,
          [Name] nvarchar(max) NOT NULL,
          [MyProperty] int NOT NULL,
          [PublishingYear] int NOT NULL,
          [AuthorsId] int NOT NULL,
          CONSTRAINT [PK_books] PRIMARY KEY ([Id]),
          CONSTRAINT [FK_books_authors_AuthorsId] FOREIGN KEY ([AuthorsId]) REFERENCES [authors] ([Id]) ON DELETE CASCADE
      );
info: 28.08.2022 18:10:39.216 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (3ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE TABLE [ArtistWork] (
          [ArtistsArtistId] int NOT NULL,
          [WorksWorkId] int NOT NULL,
          CONSTRAINT [PK_ArtistWork] PRIMARY KEY ([ArtistsArtistId], [WorksWorkId]),
          CONSTRAINT [FK_ArtistWork_artists_ArtistsArtistId] FOREIGN KEY ([ArtistsArtistId]) REFERENCES [artists] ([ArtistId]) ON DELETE CASCADE,
          CONSTRAINT [FK_ArtistWork_works_WorksWorkId] FOREIGN KEY ([WorksWorkId]) REFERENCES [works] ([WorkId]) ON DELETE CASCADE
      );
info: 28.08.2022 18:10:39.217 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE INDEX [IX_ArtistWork_WorksWorkId] ON [ArtistWork] ([WorksWorkId]);
info: 28.08.2022 18:10:39.218 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (1ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      CREATE INDEX [IX_books_AuthorsId] ON [books] ([AuthorsId]);
info: 28.08.2022 18:10:39.505 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (51ms) [Parameters=[@p0='artist1' (Nullable = false) (Size = 4000), @p1='artist2' (Nullable = false) (Size = 4000), @p2='work1' (Nullable = false) (Size = 4000), @p3='work2' (Nullable = false) (Size = 4000)], CommandType='Text', CommandTimeout='30']
      SET NOCOUNT ON;
      DECLARE @inserted0 TABLE ([ArtistId] int, [_Position] [int]);
      MERGE [artists] USING (
      VALUES (@p0, 0),
      (@p1, 1)) AS i ([FullName], _Position) ON 1=0
      WHEN NOT MATCHED THEN
      INSERT ([FullName])
      VALUES (i.[FullName])
      OUTPUT INSERTED.[ArtistId], i._Position
      INTO @inserted0;
      
      SELECT [i].[ArtistId] FROM @inserted0 i
      ORDER BY [i].[_Position];
      
      DECLARE @inserted2 TABLE ([WorkId] int, [_Position] [int]);
      MERGE [works] USING (
      VALUES (@p2, 0),
      (@p3, 1)) AS i ([Name], _Position) ON 1=0
      WHEN NOT MATCHED THEN
      INSERT ([Name])
      VALUES (i.[Name])
      OUTPUT INSERTED.[WorkId], i._Position
      INTO @inserted2;
      
      SELECT [i].[WorkId] FROM @inserted2 i
      ORDER BY [i].[_Position];
info: 28.08.2022 18:10:39.545 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (3ms) [Parameters=[@p0='1', @p1='1'], CommandType='Text', CommandTimeout='30']
      SET NOCOUNT ON;
      INSERT INTO [ArtistWork] ([ArtistsArtistId], [WorksWorkId])
      VALUES (@p0, @p1);
info: 28.08.2022 18:10:39.546 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (0ms) [Parameters=[@p0='2', @p1='1'], CommandType='Text', CommandTimeout='30']
      SET NOCOUNT ON;
      INSERT INTO [ArtistWork] ([ArtistsArtistId], [WorksWorkId])
      VALUES (@p0, @p1);
info: 28.08.2022 18:10:39.547 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (0ms) [Parameters=[@p0='2', @p1='2'], CommandType='Text', CommandTimeout='30']
      SET NOCOUNT ON;
      INSERT INTO [ArtistWork] ([ArtistsArtistId], [WorksWorkId])
      VALUES (@p0, @p1);
info: 28.08.2022 18:10:40.016 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (10ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [a].[ArtistId], [a].[FullName], [t].[ArtistsArtistId], [t].[WorksWorkId], [t].[WorkId], [t].[Name]
      FROM [artists] AS [a]
      LEFT JOIN (
          SELECT [a0].[ArtistsArtistId], [a0].[WorksWorkId], [w].[WorkId], [w].[Name]
          FROM [ArtistWork] AS [a0]
          INNER JOIN [works] AS [w] ON [a0].[WorksWorkId] = [w].[WorkId]
      ) AS [t] ON [a].[ArtistId] = [t].[ArtistsArtistId]
      ORDER BY [a].[ArtistId], [t].[ArtistsArtistId], [t].[WorksWorkId]
info: 28.08.2022 18:10:40.065 RelationalEventId.CommandExecuted[20101] (Microsoft.EntityFrameworkCore.Database.Command) 
      Executed DbCommand (7ms) [Parameters=[], CommandType='Text', CommandTimeout='30']
      SELECT [w].[WorkId], [w].[Name], [t].[ArtistsArtistId], [t].[WorksWorkId], [t].[ArtistId], [t].[FullName]
      FROM [works] AS [w]
      LEFT JOIN (
          SELECT [a].[ArtistsArtistId], [a].[WorksWorkId], [a0].[ArtistId], [a0].[FullName]
          FROM [ArtistWork] AS [a]
          INNER JOIN [artists] AS [a0] ON [a].[ArtistsArtistId] = [a0].[ArtistId]
      ) AS [t] ON [w].[WorkId] = [t].[WorksWorkId]
      ORDER BY [w].[WorkId], [t].[ArtistsArtistId], [t].[WorksWorkId]
